#!/usr/bin/env python
#
# ======================================================================
#
#                           Brad T. Aagaard
#                        U.S. Geological Survey
#
# {LicenseText}
#
# ======================================================================
#
## @file tests/libtests/data/testsimpledbarea.odb
## @brief Python data generator for tests of C++ SimpleDB using
## TestSimpleDBArea.

def query_data():
  """Factory method for facility query_data."""
  return AreaData()

from SimpleDBQueryData import SimpleDBQueryData

# AreaData class
class AreaData(SimpleDBQueryData):
  """Python data generator for tests of C++ SimpleDBQuery using
  TestSimpleDBArea."""

  def initialize(self):
    """Initialize."""

    self._names = [ "One", "Two" ]
    self._tdata = [ {'s': 0.0, 't': 0.0, 'one': 0.1, 'two': 1.1},
                    {'s': 1.0, 't': 0.0, 'one': 0.3, 'two': 3.3},
                    {'s': 4.0, 't': 0.0, 'one': 0.2, 'two': 2.2},
                    {'s': 4.0, 't': 3.0, 'one': 0.1, 'two': 1.1},
                    {'s': 0.0, 't': 2.0, 'one': -0.4, 'two': -4.4},
                    {'s': 0.0, 't': 3.0, 'one': -0.3, 'two': -3.2} ]
    self._topology = "spatial::SimpleDB::AREA"

    self._qtdata = [ {'s': 3.0, 't': 1.0, 'ni': 2,
                      'wts': [{'i': 1, 'w': 1.0/3.0},
                              {'i': 2, 'w': 1.0/3.0},
                              {'i': 3, 'w': 1.0/3.0}] },
                     {'s': 0.25, 't': 0.75, 'ni': 0,
                      'wts': [{'i': 0, 'w': 0.375},
                              {'i': 1, 'w': 0.250},
                              {'i': 4, 'w': 0.375}] },
                     {'s': 1.0, 't': 2.75, 'ni': 5,
                      'wts': [{'i': 5, 'w': 0.50},
                              {'i': 4, 'w': 0.25},
                              {'i': 3, 'w': 0.25}]} ]
    self._numLocs = len(self._tdata)
    self._numVals = len(self._names)
    self._numQueries = len(self._qtdata)

    self._compute()
    return

  def _compute(self):
    """Compute locations of points and values."""
    o = [3.4, 9.5, 8.7]
    sqrt5 = 5**0.5
    sqrt21 = 21**0.5
    a = [2.0/sqrt5, 0, 1.0/sqrt5]
    b = [1.0/sqrt21, 4/sqrt21, -2/sqrt21]
    self._data = []
    for loc in self._tdata:
      s = loc['s']
      t = loc['t']
      x = o[0] + a[0]*s + b[0]*t
      y = o[1] + a[1]*s + b[1]*t
      z = o[2] + a[2]*s + b[2]*t
      self._data += [x, y, z, loc['one'], loc['two']]
    
    self._qldata = []
    self._qndata = []
    for qloc in self._qtdata:
      s = qloc['s']
      t = qloc['t']
      x = o[0] + a[0]*s + b[0]*t
      y = o[1] + a[1]*s + b[1]*t
      z = o[2] + a[2]*s + b[2]*t
      v1 = 0
      v2 = 0
      for wt in qloc['wts']:
        v1 += self._tdata[wt['i']]['one']*wt['w']
        v2 += self._tdata[wt['i']]['two']*wt['w']
      self._qldata += [x, y, z, v1, v2]
      v1 = self._tdata[qloc['ni']]['one']
      v2 = self._tdata[qloc['ni']]['two']
      self._qndata += [x, y, z, v1, v2]    
    return

  def __init__(self):
    """Constructor."""
    SimpleDBQueryData.__init__(self, name="areadata")
    return

# version
__id__ = "$Id: testsimpledbarea.odb,v 1.1 2005/03/17 22:18:34 baagaard Exp $"

# End of file 
